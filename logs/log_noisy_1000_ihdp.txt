I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: TITAN Xp
major: 6 minor: 1 memoryClockRate (GHz) 1.582
pciBusID 0000:02:00.0
Total memory: 11.91GiB
Free memory: 10.42GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x334c280
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: TITAN Xp
major: 6 minor: 1 memoryClockRate (GHz) 1.582
pciBusID 0000:03:00.0
Total memory: 11.91GiB
Free memory: 9.88GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3350570
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 2 with properties: 
name: TITAN Xp
major: 6 minor: 1 memoryClockRate (GHz) 1.582
pciBusID 0000:82:00.0
Total memory: 11.91GiB
Free memory: 11.12GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3354860
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 3 with properties: 
name: TITAN Xp
major: 6 minor: 1 memoryClockRate (GHz) 1.582
pciBusID 0000:83:00.0
Total memory: 11.91GiB
Free memory: 11.12GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 2
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 3
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 2
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 3
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 2 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 2 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 3 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 3 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 2 3 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y Y N N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   Y Y N N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 2:   N N Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 3:   N N Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: TITAN Xp, pci bus id: 0000:02:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: TITAN Xp, pci bus id: 0000:03:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: TITAN Xp, pci bus id: 0000:82:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: TITAN Xp, pci bus id: 0000:83:00.0)
/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients_impl.py:91: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
------------------------------
Run 1 of 100:
------------------------------
dim_in: 20
dim_out: 100
n_in: 3
batch_size: 200
n_out: 3
Traceback (most recent call last):
  File "cfr_param_search.py", line 87, in <module>
    run(sys.argv[1], int(sys.argv[2]))
  File "cfr_param_search.py", line 77, in run
    call('python cfr_net_train.py %s' % flags, shell=True)
  File "/usr/lib/python2.7/subprocess.py", line 522, in call
Training with hyperparameters: alpha=0, lambda=0.0001
Training data: data/IHDP/noisy_1000_ihdp_npci_1-1000.train.npz
Test data:     data/IHDP/noisy_1000_ihdp_npci_1-1000.test.npz
Loaded data with shape [672,1025]
Defining graph...

Training on experiment 1/10...
0	Obj: 24.246,	F: 3.812,	Cf: 6.006,	Imb: 7e-05,	Val: 3.842,	ValImb: -2.6e-07,	ValObj: 24.59
100	Obj: 0.121,	F: 0.434,	Cf: 2.490,	Imb: 0.12,	Val: 2.311,	ValImb: 0.0076,	ValObj: 6.18
200	Obj: 0.010,	F: 0.095,	Cf: 2.793,	Imb: 0.087,	Val: 2.611,	ValImb: -0.00085,	ValObj: 7.27
300	Obj: 0.008,	F: 0.071,	Cf: 2.873,	Imb: 0.084,	Val: 2.716,	ValImb: -0.00021,	ValObj: 7.80
400	Obj: 0.006,	F: 0.055,	Cf: 2.840,	Imb: 0.084,	Val: 2.710,	ValImb: -0.00088,	ValObj: 7.76
500	Obj: 0.005,	F: 0.032,	Cf: 2.857,	Imb: 0.085,	Val: 2.683,	ValImb: -0.0023,	ValObj: 7.60
600	Obj: 0.005,	F: 0.034,	Cf: 2.846,	Imb: 0.086,	Val: 2.667,	ValImb: -0.0025,	ValObj: 7.48
700	Obj: 0.010,	F: 0.094,	Cf: 2.777,	Imb: 0.082,	Val: 2.669,	ValImb: -0.0023,	ValObj: 7.50
800	Obj: 0.006,	F: 0.047,	Cf: 2.836,	Imb: 0.083,	Val: 2.642,	ValImb: -0.0031,	ValObj: 7.45
900	Obj: 0.004,	F: 0.013,	Cf: 2.827,	Imb: 0.081,	Val: 2.640,	ValImb: -0.003,	ValObj: 7.39
1000	Obj: 0.004,	F: 0.004,	Cf: 2.834,	Imb: 0.082,	Val: 2.638,	ValImb: -0.0029,	ValObj: 7.38
1100	Obj: 0.004,	F: 0.002,	Cf: 2.842,	Imb: 0.082,	Val: 2.641,	ValImb: -0.0028,	ValObj: 7.38
Traceback (most recent call last):
  File "cfr_net_train.py", line 430, in <module>
    return Popen(*popenargs, **kwargs).wait()
  File "/usr/lib/python2.7/subprocess.py", line 1376, in wait
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 43, in run
    sys.exit(main(sys.argv[:1] + flags_passthrough))
  File "cfr_net_train.py", line 423, in main
    run(outdir)
  File "cfr_net_train.py", line 370, in run
    pid, sts = _eintr_retry_call(os.waitpid, self.pid, 0)
    D_exp_test, logfile, i_exp)
  File "/usr/lib/python2.7/subprocess.py", line 476, in _eintr_retry_call
  File "cfr_net_train.py", line 137, in train
    CFR.r_alpha: FLAGS.p_alpha, CFR.r_lambda: FLAGS.p_lambda, CFR.p_t: p_treated})
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 766, in run
    return func(*args)
KeyboardInterrupt
    run_metadata_ptr)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 918, in _run
    allow_operation=False)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 2318, in as_graph_element
    return self._as_graph_element_locked(obj, allow_tensor, allow_operation)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 2396, in _as_graph_element_locked
    if obj.graph is not self:
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 323, in graph
    return self._op.graph
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 1372, in graph
    return self._graph
KeyboardInterrupt
